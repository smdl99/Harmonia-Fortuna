<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <meta
      http-equiv="Content-Security-Policy"
      content="
default-src 'self';
script-src 'self' 'unsafe-inline';
style-src 'self' https://fonts.googleapis.com 'unsafe-inline';
font-src https://fonts.gstatic.com;
img-src 'self' data:;
connect-src 'self';
object-src 'none';
base-uri 'self';
frame-ancestors 'none';
form-action 'self';
upgrade-insecure-requests;
block-all-mixed-content;
"
    />

    <meta http-equiv="X-Content-Type-Options" content="nosniff" />
    <meta http-equiv="Referrer-Policy" content="no-referrer" />
    <meta http-equiv="X-Frame-Options" content="DENY" />

    <title>Client Access | Harmonia Fortuna</title>
    <meta
      name="description"
      content="Secure access for partners of Harmonia Fortuna. Confidential reporting and protected communication within a private environment."
    />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400&display=swap"
      rel="stylesheet"
    />

    <link
      rel="icon"
      href="public/HF Logo 32x32.png"
      sizes="32x32"
      type="image/png"
    />
    <link
      rel="icon"
      href="public/HF Logo.ico"
      type="image/x-icon"
      sizes="32x32"
    />
    <link rel="icon" href="public/HF Logo.svg" type="image/svg+xml" />

    <style>
      :root {
        --page-bg: #f6f6f6;
        --container-bg: #f9f9f9;
        --text: #000;
        --cursor: #777;
      }
      body.dark {
        --page-bg: #0f0f0f;
        --container-bg: #121212;
        --text: #fff;
        --cursor: #aaa;
      }
      body {
        margin: 0;
        background: var(--page-bg);
        font-family: 'Inter', sans-serif;
        color: var(--text);
        transition: 0.4s;
        cursor: none;
        user-select: none;
      }
      body.rtl {
        direction: rtl;
      }

      .outer {
        min-height: 100vh;
        padding: clamp(4px, 1vw, 8px);
      }
      .inner {
        min-height: calc(100vh - clamp(8px, 2vw, 16px));
        background: linear-gradient(
          to bottom,
          var(--container-bg),
          rgba(0, 0, 0, 0.01)
        );
        border-radius: 18px;
        box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.015);
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        overflow: hidden;
        padding-top: 0;
      }

      .lang {
        position: absolute;
        top: clamp(18px, 3vh, 28px);
        right: clamp(18px, 3vw, 40px);
        font-size: clamp(9px, 1vw, 13px);
        opacity: 0.35;
      }
      body.rtl .lang {
        right: auto;
        left: clamp(18px, 3vw, 40px);
      }
      .lang span {
        margin-left: clamp(10px, 1.5vw, 16px);
        cursor: pointer;
      }

      .lang-fade-out {
        opacity: 0;
        transform: translateY(3px);
        transition:
          opacity 0.35s cubic-bezier(0.4, 0, 0.2, 1),
          transform 0.35s cubic-bezier(0.4, 0, 0.2, 1);
      }
      .lang-fade-in {
        opacity: 1;
        transform: translateY(0);
        transition:
          opacity 0.5s cubic-bezier(0.4, 0, 0.2, 1),
          transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .content {
        width: 60%;
        max-width: 400px;
        text-align: left;
      }

      .back-top {
        font-size: clamp(10px, 1vw, 11px);
        opacity: 0.6;
        cursor: pointer;
        display: inline-block;
        margin-bottom: clamp(16px, 3vh, 22px);
        position: relative;
        color: inherit;
        text-decoration: none;
      }
      .back-top::after,
      .actions span::after,
      .footer span::after {
        content: '';
        position: absolute;
        left: 0;
        bottom: -2px;
        width: 0;
        height: 1px;
        background: currentColor;
        transition: 0.3s;
      }
      .back-top:hover::after,
      .actions span:hover::after,
      .footer span:hover::after {
        width: 100%;
      }

      .title {
        font-size: clamp(20px, 2.5vw, 28px);
        font-weight: 300;
        letter-spacing: 2px;
      }

      .login-box {
        margin-top: clamp(22px, 4vh, 30px);
        display: flex;
        flex-direction: column;
        gap: clamp(14px, 2.5vh, 18px);
      }

      .login-box input {
        background: transparent;
        border: none;
        border-bottom: 1px solid rgba(0, 0, 0, 0.2);
        padding: 8px 2px;
        font-size: clamp(12px, 1.3vw, 14px);
        color: var(--text);
        outline: none;
        transition: 0.3s;
      }
      body.dark .login-box input {
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      }
      .login-box input:focus {
        border-bottom: 1px solid currentColor;
      }

      .login-box button {
        background: transparent;
        border: 1px solid currentColor;
        padding: 8px 0;
        font-size: clamp(11px, 1.2vw, 13px);
        cursor: pointer;
        transition: 0.3s;
        color: var(--text);
      }

      body:not(.dark) .login-box button:hover {
        background: #000;
        color: #fff;
      }
      body.dark .login-box button:hover {
        background: #fff;
        color: #000;
      }

      .error {
        font-size: clamp(10px, 1vw, 12px);
        opacity: 0;
        transform: translateY(-4px);
        transition: 0.3s;
        color: #c44;
      }
      .error.show {
        opacity: 1;
        transform: translateY(0);
      }

      .actions {
        position: absolute;
        bottom: 36px;
        left: 50%;
        transform: translateX(-50%);
        font-size: clamp(10px, 1vw, 11px);
        opacity: 0.6;
      }
      .actions span {
        margin: 0 8px;
        cursor: pointer;
        position: relative;
      }

      .footer {
        position: absolute;
        bottom: 8px;
        left: 50%;
        transform: translateX(-50%);
        font-size: clamp(8px, 0.8vw, 11px);
        opacity: 0.26;
        text-align: center;
      }
      .footer span {
        margin: 0 clamp(4px, 1vw, 6px);
        cursor: pointer;
        position: relative;
      }

      .cursor-dot {
        position: fixed;
        width: 4px;
        height: 4px;
        border-radius: 50%;
        background: var(--cursor);
        pointer-events: none;
        transform: translate(-50%, -50%);
        z-index: 9999;
      }

      /* ===== MOBILE REAL SPACE REDUCTION (TOP & BOTTOM) ===== */
      @media (max-width: 600px) {
        /* Remove large top padding */
        .inner {
          padding-top: 5px !important;
        }

        /* Reduce space under Back button */
        .back-top {
          margin-bottom: 8px !important;
        }

        /* Reduce space above inputs */
        .login-box {
          margin-top: 12px !important;
          gap: 12px !important;
        }

        /* Reduce space under Login button */
        .login-box button {
          margin-top: 4px !important;
        }

        /* Keep Dark Mode in balanced lower position */
        .actions {
          bottom: 40px !important;
        }

        /* Footer single line and slightly tighter */
        .footer {
          bottom: 10px !important;
          white-space: nowrap !important;
        }
      }
    </style>
  </head>
  <body>
    <div class="cursor-dot" id="cursor"></div>

    <div class="outer">
      <div class="inner">
        <div class="lang" id="langMenu">
          <span data-lang="en">EN</span>
          <span data-lang="cn">中文</span>
          <span data-lang="ru">RU</span>
          <span data-lang="ar">AR</span>
        </div>

        <div class="content">
          <a href="/menu.html" class="back-top" id="backBtnTop">← Back</a>
          <div class="title" id="title">Login</div>

          <form class="login-box" id="loginForm" autocomplete="off" novalidate>
            <input type="text" id="username" maxlength="32" />
            <input type="password" id="password" maxlength="64" />
            <div class="error" id="errorMsg">Invalid credentials</div>
            <button type="submit" id="loginBtn">Login</button>
          </form>
        </div>

        <div class="actions">
          <span id="modeBtn">Dark Mode</span>
        </div>

        <div class="footer">
          ©<span id="year"></span> Harmonia Fortuna |
          <span id="privacyBtn">Privacy Policy</span> |
          <span id="termsBtn">Terms of Service</span>
        </div>
      </div>
    </div>

    <script>
      'use strict';

      document.getElementById('year').textContent = new Date().getFullYear();

      const translations = {
        en: {
          title: 'Login',
          user: 'Username',
          pass: 'Password',
          login: 'Login',
          error: 'Invalid credentials',
          back: '← Back',
          dark: 'Dark Mode',
          privacy: 'Privacy Policy',
          terms: 'Terms of Service',
        },
        cn: {
          title: '登录',
          user: '用户名',
          pass: '密码',
          login: '登录',
          error: '凭证无效',
          back: '← 返回',
          dark: '深色模式',
          privacy: '隐私政策',
          terms: '服务条款',
        },
        ru: {
          title: 'Вход',
          user: 'Имя пользователя',
          pass: 'Пароль',
          login: 'Войти',
          error: 'Неверные данные',
          back: '← Назад',
          dark: 'Тёмный режим',
          privacy: 'Конфиденциальность',
          terms: 'Условия',
        },
        ar: {
          title: 'تسجيل الدخول',
          user: 'اسم المستخدم',
          pass: 'كلمة المرور',
          login: 'دخول',
          error: 'بيانات غير صحيحة',
          back: '← رجوع',
          dark: 'الوضع الداكن',
          privacy: 'سياسة الخصوصية',
          terms: 'الشروط',
        },
      };

      function setLang(lang) {
        const elements = [
          title,
          username,
          password,
          loginBtn,
          errorMsg,
          backBtnTop,
          modeBtn,
          privacyBtn,
          termsBtn,
        ];

        elements.forEach((el) => {
          el.classList.remove('lang-fade-in');
          el.classList.add('lang-fade-out');
        });

        setTimeout(() => {
          document.body.classList.toggle('rtl', lang === 'ar');
          document.documentElement.lang = lang;

          const t = translations[lang];
          title.textContent = t.title;
          username.placeholder = t.user;
          password.placeholder = t.pass;
          loginBtn.textContent = t.login;
          errorMsg.textContent = t.error;
          backBtnTop.textContent = t.back;
          modeBtn.textContent = t.dark;
          privacyBtn.textContent = t.privacy;
          termsBtn.textContent = t.terms;

          elements.forEach((el) => {
            el.classList.remove('lang-fade-out');
            el.classList.add('lang-fade-in');
          });
        }, 200);
      }

      langMenu.addEventListener('click', (e) => {
        if (e.target.dataset.lang) {
          setLang(e.target.dataset.lang);
        }
      });

      setLang('en');
      modeBtn.textContent = 'Dark Mode';

      modeBtn.addEventListener('click', () => {
        document.body.classList.toggle('dark');
        modeBtn.textContent = document.body.classList.contains('dark')
          ? 'Light Mode'
          : 'Dark Mode';
      });

      let attempts = 0;
      let lockUntil = 0;

      function secureCompare(a, b) {
        if (a.length !== b.length) return false;
        let result = 0;
        for (let i = 0; i < a.length; i++) {
          result |= a.charCodeAt(i) ^ b.charCodeAt(i);
        }
        return result === 0;
      }

      loginForm.addEventListener('submit', (e) => {
        e.preventDefault();
        if (Date.now() < lockUntil) return;

        const user = username.value.trim();
        const pass = password.value.trim();

        if (!/^[a-zA-Z0-9._-]{3,32}$/.test(user)) {
          showError();
          return;
        }

        const ok =
          secureCompare(user, 'admin') && secureCompare(pass, 'harmonia');

        if (ok) {
          alert('Login successful');
        } else {
          attempts++;
          if (attempts >= 5) {
            lockUntil = Date.now() + 10000;
            attempts = 0;
          }
          showError();
        }
      });

      function showError() {
        errorMsg.classList.add('show');
        setTimeout(() => errorMsg.classList.remove('show'), 2500);
      }

      const cursor = document.getElementById('cursor');
      let cx = innerWidth / 2,
        cy = innerHeight / 2,
        tx = cx,
        ty = cy;
      addEventListener('mousemove', (e) => {
        tx = e.clientX;
        ty = e.clientY;
      });
      (function animateCursor() {
        cx += (tx - cx) * 0.15;
        cy += (ty - cy) * 0.15;
        cursor.style.left = cx + 'px';
        cursor.style.top = cy + 'px';
        requestAnimationFrame(animateCursor);
      })();
    </script>
  </body>
</html>
